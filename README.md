# TransMatch
PyTorch implementation of Paper "TransMatch: Transformer-based Correspondence Pruning via Local and Global Consensus"


# Requirements

Please use Python 3.6, opencv-contrib-python (3.4.0.12) and Pytorch (>= 1.1.0). Other dependencies should be easily installed through pip or conda.

# Data Processing
The code of this part is partially borrowed from [[OANet](https://github.com/zjhthu/OANet)] [[CNe](https://github.com/vcg-uvic/learned-correspondence-release)]. Please follow their instructions to download the training and testing data.

    bash download_data.sh raw_data raw_data_yfcc.tar.gz 0 8 ## YFCC100M
    tar -xvf raw_data_yfcc.tar.gz

    bash download_data.sh raw_sun3d_test raw_sun3d_test.tar.gz 0 2 ## SUN3D
    tar -xvf raw_sun3d_test.tar.gz
    bash download_data.sh raw_sun3d_train raw_sun3d_train.tar.gz 0 63
    tar -xvf raw_sun3d_train.tar.gz

After downloading the datasets, the initial matches can be generated by:

    cd dump_match
    bash yfcc.sh
    bash sun3d.sh

The initial matches are generated over SIFT by default. 
## Pretrained Model

We provide a pretrained model on YFCC100M. The results in our paper can be reproduced by running the test script:

    python main.py --run_mode=test --model_path=./log/train
## Train model on YFCC100M
Please run the training script to train our model on YFCC100M after the data processing is done.

    python main.py ./data_dump/yfcc-sift-2000-train.hdf5
    --data_te ./data_dump/yfcc-sift-2000-test.hdf5
